<!doctype html>
<html class="no-js" lang="">

<head>
  <meta charset="utf-8">
  <title></title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- These are Open Graph meta tags used for social media sharing. 
    They provide information such as the title, type, URL, and image 
    for social media platforms to display when the webpage is shared. -->
  <meta property="og:title" content="">
  <meta property="og:type" content="">
  <meta property="og:url" content="">
  <meta property="og:image" content="">

  <link rel="manifest" href="site.webmanifest">
  <link rel="apple-touch-icon" href="icon.png">
  <!-- Place favicon.ico in the root directory -->

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Jura&family=Orbitron&family=Montserrat&family=Ysabeau+SC&display=swap" rel="stylesheet">
  
  <!-- CSS Stylesheets -->
  <link rel="stylesheet" href="css/normalize.css"> 
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/triton.css">

  <meta name="theme-color" content="#fafafa">
</head>

<body class="flex-container">
  
  <!-- JS files-->
  <script src="js/vendor/modernizr-3.11.2.min.js"></script>
  <script src="js/plugins.js"></script>
  <script src="js/main.js"></script>
  
  <!-- Include PapaParse Library--> 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
  
  <!-- Google Analytics: change UA-XXXXX-Y to be your site's ID. 
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-XXXXX-Y', 'auto'); ga('set', 'anonymizeIp', true); ga('set', 'transport', 'beacon'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async></script>
  -->

  <!-- Highcharts CDN -->
  <script src="https://code.highcharts.com/highcharts.js"></script>
  <script src="https://code.highcharts.com/modules/histogram-bellcurve.js"></script>
  <script src="https://code.highcharts.com/modules/exporting.js"></script>
  <script src="https://code.highcharts.com/modules/accessibility.js"></script>

  <!-- Title and Tagline -->
  <header class="flex-container">
    <h1 class="flex-item title">VIZZY</h1>
    <h3 class="flex-item tagline">Data Visualizations for Runners</h3>
  </header>

  <!-- User input form -->
  <form class="flex-container input-section" >
      <h4 class="flex-item">Select CSV File containing race results</h4>
      <!----------------- Button to choose CSV File in browser -------------->
      <input type="file" onchange=read(this)>
    </form>

  <main>
    <!------------------ Finish Time Histogram ------------------------------>
    <figure class="highcharts-figure">
      <div id="histogram"></div>
    </figure>

    <script>     //Initialize options for Finish Time Histogram
      let histChart = Highcharts.chart('histogram', {
        title: { text: 'Finish Times with Histogram' },
        xAxis: [{
            //invisible scatterplot x-axis opposite main x-axis
            type: 'datetime',
            opposite: true,
            min: 15*60*1000,
            visible: false
        }, {
            //histogram x-axis for finish time
            type: 'datetime',
            title: { text: 'Finish Time (HH:MM)' },
            min: 15*60*1000,  
        }],
        yAxis: [{
          //scatterplot y-axis for Finish Time
          type: 'datetime',
          min: 15*60*1000,
          gridLineWidth: 0,
          opposite: true,
          visible: false
        }, {
          //histogram y-axis 
          title: { text: 'Bin Count' },
        }],
        //tooltip formatting for histogram and scatterplot using HTML
        tooltip: {
          xDateFormat: '%M:%S',
          useHTML: true,
          headerFormat: '<table><tr><th colspan="2">{point.key}</th></tr>',
          pointFormat: '<tr><td style="color: {series.color}">{series.name} </td>' +
                '<td style="text-align: right"><b>{point.y} </b></td></tr>',
          footerFormat: '</table>',
        },

        //legend options
        legend: {
          layout: 'vertical',
          align: 'right',
          floating: true,
          verticalAlign: 'middle',
          x: -100,
        },

        //accessibility options for histogram
        plotOptions: {
          histogram: {
              accessibility: {
                  point: {
                      valueDescriptionFormat: '{index}. {point.x:.3f} to {point.x2:.3f}, {point.y}.'
                  }
              }
          }
        },
      })
    </script>

    <!------------------ Percentile vs. Finish time Scatterplot ------------------->
    <figure class="highcharts-figure">  
      <div id="percentile-chart"></div>
    </figure>

    <script>      //Initialize options for Percentile Scatterplot
      let percentileChart = Highcharts.chart('percentile-chart', {
        title: { text: 'Finisher Percentiles' },
        xAxis: [{
            title: { text: 'Finish Time (HH:MM)' },
            type: 'datetime',
            min: 15*60*1000,
        }],
        yAxis: [{
          title: { text: 'Percentile (%)' },
          max: 100,
        }],
        //tooltip HTML formatting for percentile scatterplot
        tooltip: {
          xDateFormat: '%H:%M:%S',
          useHTML: true,
          headerFormat: '<table><tr><th colspan="2">{point.key}</th></tr>',
          pointFormat: '<tr><td style="color: {series.color}">{series.name} </td>' +
                '<td style="text-align: right"><b>{point.y} %</b></td></tr>',
          footerFormat: '</table>',
          valueDecimals: 0
        },
        //legend options
        legend: {
          layout: 'vertical',
          align: 'right',
          floating: true,
          verticalAlign: 'middle',
          x: -50,
        }
      })
    </script>

    <!-------------- Selected CSV data gets displayed here --------------------->
    <div class="output flex-item"></div>
  </main>

  <footer class="flex-container">
    <p>Copyright 2023 by Vizzy</p>
  </footer>
  
</body>

</html>
